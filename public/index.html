<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>今天留晚嗎？</title>
    <link rel="canonical" href="https://getbootstrap.com/docs/5.1/examples/sign-in/">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="index.css" />
    <link href="/docs/5.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">


    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }
    </style>
    <script>
        var sendableData = ""
        var sd = ""

        var namelist = [
            {
                num: "31021",
                name: "余竑毅"
            },
            {
                num: "30118",
                name: "鄒芸熹"
            },
            {
                num: "0000",
                name: "測試人員"
            },
            {
                num: "30916",
                name: "蔡心瑀"
            },
            {
                num: "30939",
                name: "劉哲佑"
            }
        ]

        function load() {
            document.getElementById("floatingInput").value = ""
            sd = 1
            document.getElementById("btnGroupDrop1").innerHTML = "下課時間"
        }

        function dropdown(time) {
            var droptitle = document.getElementById("btnGroupDrop1")
            if (time == 4) {
                droptitle.innerHTML = "我四點下課"
            } else if (time == 5) {
                droptitle.innerHTML = "我五點下課"
            }
            sd = 1
            var input = document.getElementById("floatingInput")
            console.log(input.value)
            sendableData = {}
            var index = namelist.map(x => x.num).indexOf(document.getElementById("floatingInput").value)
            chineseName = namelist[index]["name"]
            console.log(namelist[index]["name"])
            sendableData["name"] = input.value + chineseName
            sendableData["time"] = time
            console.log(sendableData)

        }

        function send() {
            if (sd != 0 && sendableData == "") {
                alert("請填下課時間")
                load()
                // console.log("到底是要不要留啦？")
            } else if (document.getElementById("floatingInput").value == "") {
                console.log("阿你是誰？")
            } else if (sd != 0 && namelist.map(x => x.num).indexOf(document.getElementById("floatingInput").value) != -1) {
                // console.log(sendableData)
                $.ajax({
                    type: "POST",
                    // async: false,
                    url: "https://139.162.36.172/pp",
                    data: sendableData
                }).done(function (d) {
                    console.log(sendableData)
                })
                alert("登記完成！考試加油")
                load()

            } else {
                alert("請再次檢查座號")
                load()
            }
        }
        function jump(){
            window.location.href="https://139.162.36.172/result.html"
        }

    </script>

</head>

<body class="text-center" onload="load()">

    <main class="form-signin">
        <img class="mb-0" src="./read.png" width="250" height="198" />

        <div class="row">
            <h1 class="h3 mb-3 fw-normal col" style="padding-top: 10px;">今天要留晚嗎？</h1>
        </div>

        <div class="form-floating">
            <input type="test" class="form-control" id="floatingInput" placeholder="ˇ31021">
            <label for="floatingInput">請輸入班級座號</label>
        </div>

        <div class="btn-group" role="group" aria-label="Button group with nested dropdown">

            <div class="btn-group" role="group">
                <button id="btnGroupDrop1" type="button" class="btn btn-outline-primary dropdown-toggle"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    下課時間
                </button>
                <ul class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                    <li><a class="dropdown-item" id="drop4" onclick="dropdown(4)">我四點下課</a></li>
                    <li><a class="dropdown-item" id="drop5" onclick="dropdown(5)">我五點下課</a></li>
                </ul>
            </div>
            <button type="button" class="btn btn-outline-primary" onclick="jump()" >誰有留呢？</button>
        </div>
        <button type="button" class="btn btn-primary" onclick="send(sendableData)">送出</button>


    </main>


</body>

</html>